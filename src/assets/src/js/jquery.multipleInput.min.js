!function(t){t.fn.multipleInput=function(e){return l[e]?l[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(t.error("Method "+e+" does not exist on jQuery.multipleInput"),!1):l.init.apply(this,arguments)};var e={afterInit:"afterInit",afterAddRow:"afterAddRow",beforeDeleteRow:"beforeDeleteRow",afterDeleteRow:"afterDeleteRow"},i={id:null,template:null,jsTemplates:[],limit:1,min:1},n={enableAjaxValidation:!1,validateOnBlur:!1,validateOnChange:!1,validateOnType:!1},l={init:function(l){var o=t.extend(!0,{},i,l||{}),p=t("#"+o.id),s=p.closest("form"),d=this.selector.replace("#","");p.data("multipleInput",{settings:o,currentIndex:f(p),attributeDefaults:{}}),p.on("click.multipleInput",".js-input-remove",function(e){e.stopPropagation(),r(t(this))}),p.on("click.multipleInput",".js-input-plus",function(e){e.stopPropagation(),a(t(this))});var c=setInterval(function(){if("object"==typeof s.data("yiiActiveForm")){var i=s.yiiActiveForm("find",d),l=[];"object"==typeof i&&(t.each(i,function(t,e){["id","input","container"].indexOf(t)==-1&&(l[t]=e)}),s.yiiActiveForm("remove",d));var a=t.extend({},n,o.attributeOptions);t.each(a,function(t,e){"undefined"==typeof l[t]&&(l[t]=e)}),p.data("multipleInput").attributeDefaults=l,p.find(".multiple-input-list").find("input, select, textarea").each(function(){u(t(this))}),clearInterval(c);var r=t.Event(e.afterInit);p.trigger(r)}},100)},add:function(e){a(t(this),e)},remove:function(e){var i=null;i=e?t(this).find(".js-input-remove:eq("+e+")"):t(this).find(".js-input-remove").last(),r(i)},clear:function(){t(".js-input-remove").each(function(){r(t(this))})}},a=function(i,n){var l=t(i).closest(".multiple-input").first(),a=l.data("multipleInput"),r=a.settings,o=r.template,f=l.find(".multiple-input-list").first(),s=l.find(".multiple-input-list__item").length;if(!(null!=r.limit&&s>=r.limit)){if(o=o.replaceAll("{multiple_index}",a.currentIndex),t(o).hide().appendTo(f).fadeIn(300),n instanceof Object){var d=[];for(var c in n)n.hasOwnProperty(c)&&d.push(n[c]);n=d}var m=0;t(o).find("input, select, textarea").each(function(){var e=t(this),i=e.get(0).tagName,l=p(e),a=t("#"+l);if(n){var r=n[m];if("INPUT"==i||"TEXTAREA"==i)a.val(r);else if("SELECT"==i)if(r&&r.indexOf("option")!=-1)a.append(r);else{var o=a.find('option[value="'+r+'"]');o.length&&a.val(r)}}u(e),m++});var v;for(var h in r.jsTemplates)v=r.jsTemplates[h].replaceAll("{multiple_index}",a.currentIndex).replaceAll("%7Bmultiple_index%7D",a.currentIndex),window.eval(v);l.data("multipleInput").currentIndex++;var g=t.Event(e.afterAddRow);l.trigger(g)}},r=function(i){var n=i.closest(".multiple-input").first(),l=i.closest(".multiple-input-list__item"),a=t(".multiple-input-list__item").length,r=n.data("multipleInput"),u=r.settings;if(a>u.min){var p=t.Event(e.beforeDeleteRow);if(n.trigger(p,[l]),p.result===!1)return;l.find("input, select, textarea").each(function(){o(t(this))}),l.fadeOut(300,function(){t(this).remove(),p=t.Event(e.afterDeleteRow),n.trigger(p)})}},u=function(e){var i=p(e);if(null!==i){var n=t("#"+i),l=n.closest(".multiple-input").first(),a=n.closest("form");if(0!=l.length&&0!=a.length&&"undefined"==typeof a.yiiActiveForm("find",i)){var r=l.data("multipleInput");a.yiiActiveForm("add",t.extend({},r.attributeDefaults,{id:i,input:"#"+i,container:".field-"+i}))}}},o=function(){var e=p(t(this));if(null!==e){var i=t("#"+e).closest("form");0!==i.length&&i.yiiActiveForm("remove",e)}},p=function(t){var e=t.attr("id");return"undefined"==typeof e&&(e=t.data("id")),"undefined"==typeof e?null:e},f=function(e){var i=[],n=e.find(".multiple-input-list__item");return n.each(function(e,n){var l=t(n).data("index");/^[\d]+$/.test(l)&&i.push(l)}),0==i.lenght?n.length:Math.max.apply(null,i)+1};String.prototype.replaceAll=function(t,e){return this.split(t).join(e)}}(window.jQuery);